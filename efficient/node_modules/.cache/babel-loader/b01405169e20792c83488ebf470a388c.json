{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.applyKeyframeAnimation = applyKeyframeAnimation;\nexports.stopPreviousKeyframeAnimationAndRestore = stopPreviousKeyframeAnimationAndRestore;\n\nvar _util = require(\"zrender/lib/core/util.js\");\n\nvar _customGraphicTransition = require(\"./customGraphicTransition.js\");\n\nvar _basicTrasition = require(\"./basicTrasition.js\");\n\nvar _log = require(\"../util/log.js\");\n\nvar _model = require(\"../util/model.js\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar getStateToRestore = (0, _model.makeInner)();\nvar KEYFRAME_EXCLUDE_KEYS = ['percent', 'easing', 'shape', 'style', 'extra'];\n/**\n * Stop previous keyframe animation and restore the attributes.\n * Avoid new keyframe animation starts with wrong internal state when the percent: 0 is not set.\n */\n\nfunction stopPreviousKeyframeAnimationAndRestore(el) {\n  // Stop previous keyframe animation.\n  el.stopAnimation('keyframe'); // Restore\n\n  el.attr(getStateToRestore(el));\n}\n\nfunction applyKeyframeAnimation(el, animationOpts, animatableModel) {\n  if (!animatableModel.isAnimationEnabled() || !animationOpts) {\n    return;\n  }\n\n  if ((0, _util.isArray)(animationOpts)) {\n    (0, _util.each)(animationOpts, function (singleAnimationOpts) {\n      applyKeyframeAnimation(el, singleAnimationOpts, animatableModel);\n    });\n    return;\n  }\n\n  var keyframes = animationOpts.keyframes;\n  var duration = animationOpts.duration;\n\n  if (animatableModel && duration == null) {\n    // Default to use duration of config.\n    // NOTE: animation config from payload will be ignored because they are mainly for transitions.\n    var config = (0, _basicTrasition.getAnimationConfig)('enter', animatableModel, 0);\n    duration = config && config.duration;\n  }\n\n  if (!keyframes || !duration) {\n    return;\n  }\n\n  var stateToRestore = getStateToRestore(el);\n  (0, _util.each)(_customGraphicTransition.ELEMENT_ANIMATABLE_PROPS, function (targetPropName) {\n    if (targetPropName && !el[targetPropName]) {\n      return;\n    }\n\n    var animator;\n    var endFrameIsSet = false; // Sort keyframes by percent.\n\n    keyframes.sort(function (a, b) {\n      return a.percent - b.percent;\n    });\n    (0, _util.each)(keyframes, function (kf) {\n      // Stop current animation.\n      var animators = el.animators;\n      var kfValues = targetPropName ? kf[targetPropName] : kf;\n\n      if (process.env.NODE_ENV !== 'production') {\n        if (kf.percent >= 1) {\n          endFrameIsSet = true;\n        }\n      }\n\n      if (!kfValues) {\n        return;\n      }\n\n      var propKeys = (0, _util.keys)(kfValues);\n\n      if (!targetPropName) {\n        // PENDING performance?\n        propKeys = (0, _util.filter)(propKeys, function (key) {\n          return (0, _util.indexOf)(KEYFRAME_EXCLUDE_KEYS, key) < 0;\n        });\n      }\n\n      if (!propKeys.length) {\n        return;\n      }\n\n      if (!animator) {\n        animator = el.animate(targetPropName, animationOpts.loop, true);\n        animator.scope = 'keyframe';\n      }\n\n      for (var i = 0; i < animators.length; i++) {\n        // Stop all other animation that is not keyframe.\n        if (animators[i] !== animator && animators[i].targetName === animator.targetName) {\n          animators[i].stopTracks(propKeys);\n        }\n      }\n\n      targetPropName && (stateToRestore[targetPropName] = stateToRestore[targetPropName] || {});\n      var savedTarget = targetPropName ? stateToRestore[targetPropName] : stateToRestore;\n      (0, _util.each)(propKeys, function (key) {\n        // Save original value.\n        savedTarget[key] = ((targetPropName ? el[targetPropName] : el) || {})[key];\n      });\n      animator.whenWithKeys(duration * kf.percent, kfValues, propKeys, kf.easing);\n    });\n\n    if (!animator) {\n      return;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (!endFrameIsSet) {\n        (0, _log.warn)('End frame with percent: 1 is missing in the keyframeAnimation.', true);\n      }\n    }\n\n    animator.delay(animationOpts.delay || 0).duration(duration).start(animationOpts.easing);\n  });\n}","map":{"version":3,"names":["getStateToRestore","makeInner","KEYFRAME_EXCLUDE_KEYS","stopPreviousKeyframeAnimationAndRestore","el","stopAnimation","attr","applyKeyframeAnimation","animationOpts","animatableModel","isAnimationEnabled","isArray","each","singleAnimationOpts","keyframes","duration","config","getAnimationConfig","stateToRestore","ELEMENT_ANIMATABLE_PROPS","targetPropName","animator","endFrameIsSet","sort","a","b","percent","kf","animators","kfValues","process","env","NODE_ENV","propKeys","keys","filter","key","indexOf","length","animate","loop","scope","i","targetName","stopTracks","savedTarget","whenWithKeys","easing","warn","delay","start"],"sources":["C:/Users/Z/Desktop/efficient/node_modules/echarts/lib/animation/customGraphicKeyframeAnimation.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { keys, filter, each, isArray, indexOf } from 'zrender/lib/core/util.js';\nimport { ELEMENT_ANIMATABLE_PROPS } from './customGraphicTransition.js';\nimport { getAnimationConfig } from './basicTrasition.js';\nimport { warn } from '../util/log.js';\nimport { makeInner } from '../util/model.js';\nvar getStateToRestore = makeInner();\nvar KEYFRAME_EXCLUDE_KEYS = ['percent', 'easing', 'shape', 'style', 'extra'];\n/**\n * Stop previous keyframe animation and restore the attributes.\n * Avoid new keyframe animation starts with wrong internal state when the percent: 0 is not set.\n */\n\nexport function stopPreviousKeyframeAnimationAndRestore(el) {\n  // Stop previous keyframe animation.\n  el.stopAnimation('keyframe'); // Restore\n\n  el.attr(getStateToRestore(el));\n}\nexport function applyKeyframeAnimation(el, animationOpts, animatableModel) {\n  if (!animatableModel.isAnimationEnabled() || !animationOpts) {\n    return;\n  }\n\n  if (isArray(animationOpts)) {\n    each(animationOpts, function (singleAnimationOpts) {\n      applyKeyframeAnimation(el, singleAnimationOpts, animatableModel);\n    });\n    return;\n  }\n\n  var keyframes = animationOpts.keyframes;\n  var duration = animationOpts.duration;\n\n  if (animatableModel && duration == null) {\n    // Default to use duration of config.\n    // NOTE: animation config from payload will be ignored because they are mainly for transitions.\n    var config = getAnimationConfig('enter', animatableModel, 0);\n    duration = config && config.duration;\n  }\n\n  if (!keyframes || !duration) {\n    return;\n  }\n\n  var stateToRestore = getStateToRestore(el);\n  each(ELEMENT_ANIMATABLE_PROPS, function (targetPropName) {\n    if (targetPropName && !el[targetPropName]) {\n      return;\n    }\n\n    var animator;\n    var endFrameIsSet = false; // Sort keyframes by percent.\n\n    keyframes.sort(function (a, b) {\n      return a.percent - b.percent;\n    });\n    each(keyframes, function (kf) {\n      // Stop current animation.\n      var animators = el.animators;\n      var kfValues = targetPropName ? kf[targetPropName] : kf;\n\n      if (process.env.NODE_ENV !== 'production') {\n        if (kf.percent >= 1) {\n          endFrameIsSet = true;\n        }\n      }\n\n      if (!kfValues) {\n        return;\n      }\n\n      var propKeys = keys(kfValues);\n\n      if (!targetPropName) {\n        // PENDING performance?\n        propKeys = filter(propKeys, function (key) {\n          return indexOf(KEYFRAME_EXCLUDE_KEYS, key) < 0;\n        });\n      }\n\n      if (!propKeys.length) {\n        return;\n      }\n\n      if (!animator) {\n        animator = el.animate(targetPropName, animationOpts.loop, true);\n        animator.scope = 'keyframe';\n      }\n\n      for (var i = 0; i < animators.length; i++) {\n        // Stop all other animation that is not keyframe.\n        if (animators[i] !== animator && animators[i].targetName === animator.targetName) {\n          animators[i].stopTracks(propKeys);\n        }\n      }\n\n      targetPropName && (stateToRestore[targetPropName] = stateToRestore[targetPropName] || {});\n      var savedTarget = targetPropName ? stateToRestore[targetPropName] : stateToRestore;\n      each(propKeys, function (key) {\n        // Save original value.\n        savedTarget[key] = ((targetPropName ? el[targetPropName] : el) || {})[key];\n      });\n      animator.whenWithKeys(duration * kf.percent, kfValues, propKeys, kf.easing);\n    });\n\n    if (!animator) {\n      return;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (!endFrameIsSet) {\n        warn('End frame with percent: 1 is missing in the keyframeAnimation.', true);\n      }\n    }\n\n    animator.delay(animationOpts.delay || 0).duration(duration).start(animationOpts.easing);\n  });\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}