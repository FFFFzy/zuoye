{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Z/Desktop/efficient/efficient/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createOrUpdateImage = createOrUpdateImage;\nexports.findExistImage = findExistImage;\nexports.isImageReady = isImageReady;\n\nvar _LRU = _interopRequireDefault(require(\"../../core/LRU.js\"));\n\nvar _platform = require(\"../../core/platform.js\");\n\nvar globalImageCache = new _LRU.default(50);\n\nfunction findExistImage(newImageOrSrc) {\n  if (typeof newImageOrSrc === 'string') {\n    var cachedImgObj = globalImageCache.get(newImageOrSrc);\n    return cachedImgObj && cachedImgObj.image;\n  } else {\n    return newImageOrSrc;\n  }\n}\n\nfunction createOrUpdateImage(newImageOrSrc, image, hostEl, onload, cbPayload) {\n  if (!newImageOrSrc) {\n    return image;\n  } else if (typeof newImageOrSrc === 'string') {\n    if (image && image.__zrImageSrc === newImageOrSrc || !hostEl) {\n      return image;\n    }\n\n    var cachedImgObj = globalImageCache.get(newImageOrSrc);\n    var pendingWrap = {\n      hostEl: hostEl,\n      cb: onload,\n      cbPayload: cbPayload\n    };\n\n    if (cachedImgObj) {\n      image = cachedImgObj.image;\n      !isImageReady(image) && cachedImgObj.pending.push(pendingWrap);\n    } else {\n      image = _platform.platformApi.loadImage(newImageOrSrc, imageOnLoad, imageOnLoad);\n      image.__zrImageSrc = newImageOrSrc;\n      globalImageCache.put(newImageOrSrc, image.__cachedImgObj = {\n        image: image,\n        pending: [pendingWrap]\n      });\n    }\n\n    return image;\n  } else {\n    return newImageOrSrc;\n  }\n}\n\nfunction imageOnLoad() {\n  var cachedImgObj = this.__cachedImgObj;\n  this.onload = this.onerror = this.__cachedImgObj = null;\n\n  for (var i = 0; i < cachedImgObj.pending.length; i++) {\n    var pendingWrap = cachedImgObj.pending[i];\n    var cb = pendingWrap.cb;\n    cb && cb(this, pendingWrap.cbPayload);\n    pendingWrap.hostEl.dirty();\n  }\n\n  cachedImgObj.pending.length = 0;\n}\n\nfunction isImageReady(image) {\n  return image && image.width && image.height;\n}","map":{"version":3,"names":["globalImageCache","LRU","findExistImage","newImageOrSrc","cachedImgObj","get","image","createOrUpdateImage","hostEl","onload","cbPayload","__zrImageSrc","pendingWrap","cb","isImageReady","pending","push","platformApi","loadImage","imageOnLoad","put","__cachedImgObj","onerror","i","length","dirty","width","height"],"sources":["C:/Users/Z/Desktop/efficient/node_modules/zrender/lib/graphic/helper/image.js"],"sourcesContent":["import LRU from '../../core/LRU.js';\nimport { platformApi } from '../../core/platform.js';\nvar globalImageCache = new LRU(50);\nexport function findExistImage(newImageOrSrc) {\n    if (typeof newImageOrSrc === 'string') {\n        var cachedImgObj = globalImageCache.get(newImageOrSrc);\n        return cachedImgObj && cachedImgObj.image;\n    }\n    else {\n        return newImageOrSrc;\n    }\n}\nexport function createOrUpdateImage(newImageOrSrc, image, hostEl, onload, cbPayload) {\n    if (!newImageOrSrc) {\n        return image;\n    }\n    else if (typeof newImageOrSrc === 'string') {\n        if ((image && image.__zrImageSrc === newImageOrSrc) || !hostEl) {\n            return image;\n        }\n        var cachedImgObj = globalImageCache.get(newImageOrSrc);\n        var pendingWrap = { hostEl: hostEl, cb: onload, cbPayload: cbPayload };\n        if (cachedImgObj) {\n            image = cachedImgObj.image;\n            !isImageReady(image) && cachedImgObj.pending.push(pendingWrap);\n        }\n        else {\n            image = platformApi.loadImage(newImageOrSrc, imageOnLoad, imageOnLoad);\n            image.__zrImageSrc = newImageOrSrc;\n            globalImageCache.put(newImageOrSrc, image.__cachedImgObj = {\n                image: image,\n                pending: [pendingWrap]\n            });\n        }\n        return image;\n    }\n    else {\n        return newImageOrSrc;\n    }\n}\nfunction imageOnLoad() {\n    var cachedImgObj = this.__cachedImgObj;\n    this.onload = this.onerror = this.__cachedImgObj = null;\n    for (var i = 0; i < cachedImgObj.pending.length; i++) {\n        var pendingWrap = cachedImgObj.pending[i];\n        var cb = pendingWrap.cb;\n        cb && cb(this, pendingWrap.cbPayload);\n        pendingWrap.hostEl.dirty();\n    }\n    cachedImgObj.pending.length = 0;\n}\nexport function isImageReady(image) {\n    return image && image.width && image.height;\n}\n"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA,IAAIA,gBAAgB,GAAG,IAAIC,YAAJ,CAAQ,EAAR,CAAvB;;AACO,SAASC,cAAT,CAAwBC,aAAxB,EAAuC;EAC1C,IAAI,OAAOA,aAAP,KAAyB,QAA7B,EAAuC;IACnC,IAAIC,YAAY,GAAGJ,gBAAgB,CAACK,GAAjB,CAAqBF,aAArB,CAAnB;IACA,OAAOC,YAAY,IAAIA,YAAY,CAACE,KAApC;EACH,CAHD,MAIK;IACD,OAAOH,aAAP;EACH;AACJ;;AACM,SAASI,mBAAT,CAA6BJ,aAA7B,EAA4CG,KAA5C,EAAmDE,MAAnD,EAA2DC,MAA3D,EAAmEC,SAAnE,EAA8E;EACjF,IAAI,CAACP,aAAL,EAAoB;IAChB,OAAOG,KAAP;EACH,CAFD,MAGK,IAAI,OAAOH,aAAP,KAAyB,QAA7B,EAAuC;IACxC,IAAKG,KAAK,IAAIA,KAAK,CAACK,YAAN,KAAuBR,aAAjC,IAAmD,CAACK,MAAxD,EAAgE;MAC5D,OAAOF,KAAP;IACH;;IACD,IAAIF,YAAY,GAAGJ,gBAAgB,CAACK,GAAjB,CAAqBF,aAArB,CAAnB;IACA,IAAIS,WAAW,GAAG;MAAEJ,MAAM,EAAEA,MAAV;MAAkBK,EAAE,EAAEJ,MAAtB;MAA8BC,SAAS,EAAEA;IAAzC,CAAlB;;IACA,IAAIN,YAAJ,EAAkB;MACdE,KAAK,GAAGF,YAAY,CAACE,KAArB;MACA,CAACQ,YAAY,CAACR,KAAD,CAAb,IAAwBF,YAAY,CAACW,OAAb,CAAqBC,IAArB,CAA0BJ,WAA1B,CAAxB;IACH,CAHD,MAIK;MACDN,KAAK,GAAGW,qBAAA,CAAYC,SAAZ,CAAsBf,aAAtB,EAAqCgB,WAArC,EAAkDA,WAAlD,CAAR;MACAb,KAAK,CAACK,YAAN,GAAqBR,aAArB;MACAH,gBAAgB,CAACoB,GAAjB,CAAqBjB,aAArB,EAAoCG,KAAK,CAACe,cAAN,GAAuB;QACvDf,KAAK,EAAEA,KADgD;QAEvDS,OAAO,EAAE,CAACH,WAAD;MAF8C,CAA3D;IAIH;;IACD,OAAON,KAAP;EACH,CAnBI,MAoBA;IACD,OAAOH,aAAP;EACH;AACJ;;AACD,SAASgB,WAAT,GAAuB;EACnB,IAAIf,YAAY,GAAG,KAAKiB,cAAxB;EACA,KAAKZ,MAAL,GAAc,KAAKa,OAAL,GAAe,KAAKD,cAAL,GAAsB,IAAnD;;EACA,KAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,YAAY,CAACW,OAAb,CAAqBS,MAAzC,EAAiDD,CAAC,EAAlD,EAAsD;IAClD,IAAIX,WAAW,GAAGR,YAAY,CAACW,OAAb,CAAqBQ,CAArB,CAAlB;IACA,IAAIV,EAAE,GAAGD,WAAW,CAACC,EAArB;IACAA,EAAE,IAAIA,EAAE,CAAC,IAAD,EAAOD,WAAW,CAACF,SAAnB,CAAR;IACAE,WAAW,CAACJ,MAAZ,CAAmBiB,KAAnB;EACH;;EACDrB,YAAY,CAACW,OAAb,CAAqBS,MAArB,GAA8B,CAA9B;AACH;;AACM,SAASV,YAAT,CAAsBR,KAAtB,EAA6B;EAChC,OAAOA,KAAK,IAAIA,KAAK,CAACoB,KAAf,IAAwBpB,KAAK,CAACqB,MAArC;AACH"},"metadata":{},"sourceType":"script"}