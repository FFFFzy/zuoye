{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sortTransform = void 0;\n\nvar _types = require(\"../../util/types.js\");\n\nvar _log = require(\"../../util/log.js\");\n\nvar _util = require(\"zrender/lib/core/util.js\");\n\nvar _model = require(\"../../util/model.js\");\n\nvar _dataValueHelper = require(\"../../data/helper/dataValueHelper.js\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar sampleLog = '';\n\nif (process.env.NODE_ENV !== 'production') {\n  sampleLog = ['Valid config is like:', '{ dimension: \"age\", order: \"asc\" }', 'or [{ dimension: \"age\", order: \"asc\"], { dimension: \"date\", order: \"desc\" }]'].join(' ');\n}\n\nvar sortTransform = {\n  type: 'echarts:sort',\n  transform: function (params) {\n    var upstream = params.upstream;\n    var config = params.config;\n    var errMsg = ''; // Normalize\n    // const orderExprList: OrderExpression[] = isArray(config[0])\n    //     ? config as OrderExpression[]\n    //     : [config as OrderExpression];\n\n    var orderExprList = (0, _model.normalizeToArray)(config);\n\n    if (!orderExprList.length) {\n      if (process.env.NODE_ENV !== 'production') {\n        errMsg = 'Empty `config` in sort transform.';\n      }\n\n      (0, _log.throwError)(errMsg);\n    }\n\n    var orderDefList = [];\n    (0, _util.each)(orderExprList, function (orderExpr) {\n      var dimLoose = orderExpr.dimension;\n      var order = orderExpr.order;\n      var parserName = orderExpr.parser;\n      var incomparable = orderExpr.incomparable;\n\n      if (dimLoose == null) {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = 'Sort transform config must has \"dimension\" specified.' + sampleLog;\n        }\n\n        (0, _log.throwError)(errMsg);\n      }\n\n      if (order !== 'asc' && order !== 'desc') {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = 'Sort transform config must has \"order\" specified.' + sampleLog;\n        }\n\n        (0, _log.throwError)(errMsg);\n      }\n\n      if (incomparable && incomparable !== 'min' && incomparable !== 'max') {\n        var errMsg_1 = '';\n\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg_1 = 'incomparable must be \"min\" or \"max\" rather than \"' + incomparable + '\".';\n        }\n\n        (0, _log.throwError)(errMsg_1);\n      }\n\n      if (order !== 'asc' && order !== 'desc') {\n        var errMsg_2 = '';\n\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg_2 = 'order must be \"asc\" or \"desc\" rather than \"' + order + '\".';\n        }\n\n        (0, _log.throwError)(errMsg_2);\n      }\n\n      var dimInfo = upstream.getDimensionInfo(dimLoose);\n\n      if (!dimInfo) {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = (0, _log.makePrintable)('Can not find dimension info via: ' + dimLoose + '.\\n', 'Existing dimensions: ', upstream.cloneAllDimensionInfo(), '.\\n', 'Illegal config:', orderExpr, '.\\n');\n        }\n\n        (0, _log.throwError)(errMsg);\n      }\n\n      var parser = parserName ? (0, _dataValueHelper.getRawValueParser)(parserName) : null;\n\n      if (parserName && !parser) {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = (0, _log.makePrintable)('Invalid parser name ' + parserName + '.\\n', 'Illegal config:', orderExpr, '.\\n');\n        }\n\n        (0, _log.throwError)(errMsg);\n      }\n\n      orderDefList.push({\n        dimIdx: dimInfo.index,\n        parser: parser,\n        comparator: new _dataValueHelper.SortOrderComparator(order, incomparable)\n      });\n    }); // TODO: support it?\n\n    var sourceFormat = upstream.sourceFormat;\n\n    if (sourceFormat !== _types.SOURCE_FORMAT_ARRAY_ROWS && sourceFormat !== _types.SOURCE_FORMAT_OBJECT_ROWS) {\n      if (process.env.NODE_ENV !== 'production') {\n        errMsg = 'sourceFormat \"' + sourceFormat + '\" is not supported yet';\n      }\n\n      (0, _log.throwError)(errMsg);\n    } // Other upstream format are all array.\n\n\n    var resultData = [];\n\n    for (var i = 0, len = upstream.count(); i < len; i++) {\n      resultData.push(upstream.getRawDataItem(i));\n    }\n\n    resultData.sort(function (item0, item1) {\n      for (var i = 0; i < orderDefList.length; i++) {\n        var orderDef = orderDefList[i];\n        var val0 = upstream.retrieveValueFromItem(item0, orderDef.dimIdx);\n        var val1 = upstream.retrieveValueFromItem(item1, orderDef.dimIdx);\n\n        if (orderDef.parser) {\n          val0 = orderDef.parser(val0);\n          val1 = orderDef.parser(val1);\n        }\n\n        var result = orderDef.comparator.evaluate(val0, val1);\n\n        if (result !== 0) {\n          return result;\n        }\n      }\n\n      return 0;\n    });\n    return {\n      data: resultData\n    };\n  }\n};\nexports.sortTransform = sortTransform;","map":{"version":3,"names":["sampleLog","process","env","NODE_ENV","join","sortTransform","type","transform","params","upstream","config","errMsg","orderExprList","normalizeToArray","length","throwError","orderDefList","each","orderExpr","dimLoose","dimension","order","parserName","parser","incomparable","errMsg_1","errMsg_2","dimInfo","getDimensionInfo","makePrintable","cloneAllDimensionInfo","getRawValueParser","push","dimIdx","index","comparator","SortOrderComparator","sourceFormat","SOURCE_FORMAT_ARRAY_ROWS","SOURCE_FORMAT_OBJECT_ROWS","resultData","i","len","count","getRawDataItem","sort","item0","item1","orderDef","val0","retrieveValueFromItem","val1","result","evaluate","data"],"sources":["C:/Users/Z/Desktop/efficient/node_modules/echarts/lib/component/transform/sortTransform.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { SOURCE_FORMAT_ARRAY_ROWS, SOURCE_FORMAT_OBJECT_ROWS } from '../../util/types.js';\nimport { makePrintable, throwError } from '../../util/log.js';\nimport { each } from 'zrender/lib/core/util.js';\nimport { normalizeToArray } from '../../util/model.js';\nimport { getRawValueParser, SortOrderComparator } from '../../data/helper/dataValueHelper.js';\nvar sampleLog = '';\n\nif (process.env.NODE_ENV !== 'production') {\n  sampleLog = ['Valid config is like:', '{ dimension: \"age\", order: \"asc\" }', 'or [{ dimension: \"age\", order: \"asc\"], { dimension: \"date\", order: \"desc\" }]'].join(' ');\n}\n\nexport var sortTransform = {\n  type: 'echarts:sort',\n  transform: function (params) {\n    var upstream = params.upstream;\n    var config = params.config;\n    var errMsg = ''; // Normalize\n    // const orderExprList: OrderExpression[] = isArray(config[0])\n    //     ? config as OrderExpression[]\n    //     : [config as OrderExpression];\n\n    var orderExprList = normalizeToArray(config);\n\n    if (!orderExprList.length) {\n      if (process.env.NODE_ENV !== 'production') {\n        errMsg = 'Empty `config` in sort transform.';\n      }\n\n      throwError(errMsg);\n    }\n\n    var orderDefList = [];\n    each(orderExprList, function (orderExpr) {\n      var dimLoose = orderExpr.dimension;\n      var order = orderExpr.order;\n      var parserName = orderExpr.parser;\n      var incomparable = orderExpr.incomparable;\n\n      if (dimLoose == null) {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = 'Sort transform config must has \"dimension\" specified.' + sampleLog;\n        }\n\n        throwError(errMsg);\n      }\n\n      if (order !== 'asc' && order !== 'desc') {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = 'Sort transform config must has \"order\" specified.' + sampleLog;\n        }\n\n        throwError(errMsg);\n      }\n\n      if (incomparable && incomparable !== 'min' && incomparable !== 'max') {\n        var errMsg_1 = '';\n\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg_1 = 'incomparable must be \"min\" or \"max\" rather than \"' + incomparable + '\".';\n        }\n\n        throwError(errMsg_1);\n      }\n\n      if (order !== 'asc' && order !== 'desc') {\n        var errMsg_2 = '';\n\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg_2 = 'order must be \"asc\" or \"desc\" rather than \"' + order + '\".';\n        }\n\n        throwError(errMsg_2);\n      }\n\n      var dimInfo = upstream.getDimensionInfo(dimLoose);\n\n      if (!dimInfo) {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = makePrintable('Can not find dimension info via: ' + dimLoose + '.\\n', 'Existing dimensions: ', upstream.cloneAllDimensionInfo(), '.\\n', 'Illegal config:', orderExpr, '.\\n');\n        }\n\n        throwError(errMsg);\n      }\n\n      var parser = parserName ? getRawValueParser(parserName) : null;\n\n      if (parserName && !parser) {\n        if (process.env.NODE_ENV !== 'production') {\n          errMsg = makePrintable('Invalid parser name ' + parserName + '.\\n', 'Illegal config:', orderExpr, '.\\n');\n        }\n\n        throwError(errMsg);\n      }\n\n      orderDefList.push({\n        dimIdx: dimInfo.index,\n        parser: parser,\n        comparator: new SortOrderComparator(order, incomparable)\n      });\n    }); // TODO: support it?\n\n    var sourceFormat = upstream.sourceFormat;\n\n    if (sourceFormat !== SOURCE_FORMAT_ARRAY_ROWS && sourceFormat !== SOURCE_FORMAT_OBJECT_ROWS) {\n      if (process.env.NODE_ENV !== 'production') {\n        errMsg = 'sourceFormat \"' + sourceFormat + '\" is not supported yet';\n      }\n\n      throwError(errMsg);\n    } // Other upstream format are all array.\n\n\n    var resultData = [];\n\n    for (var i = 0, len = upstream.count(); i < len; i++) {\n      resultData.push(upstream.getRawDataItem(i));\n    }\n\n    resultData.sort(function (item0, item1) {\n      for (var i = 0; i < orderDefList.length; i++) {\n        var orderDef = orderDefList[i];\n        var val0 = upstream.retrieveValueFromItem(item0, orderDef.dimIdx);\n        var val1 = upstream.retrieveValueFromItem(item1, orderDef.dimIdx);\n\n        if (orderDef.parser) {\n          val0 = orderDef.parser(val0);\n          val1 = orderDef.parser(val1);\n        }\n\n        var result = orderDef.comparator.evaluate(val0, val1);\n\n        if (result !== 0) {\n          return result;\n        }\n      }\n\n      return 0;\n    });\n    return {\n      data: resultData\n    };\n  }\n};"],"mappings":"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"},"metadata":{},"sourceType":"script"}