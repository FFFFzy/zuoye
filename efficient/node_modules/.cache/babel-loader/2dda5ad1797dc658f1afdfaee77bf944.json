{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Z/Desktop/efficient/efficient/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GeoJSONResource = void 0;\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nvar _util = require(\"zrender/lib/core/util.js\");\n\nvar _parseGeoJson = _interopRequireDefault(require(\"./parseGeoJson.js\"));\n\nvar _nanhai = _interopRequireDefault(require(\"./fix/nanhai.js\"));\n\nvar _textCoord = _interopRequireDefault(require(\"./fix/textCoord.js\"));\n\nvar _diaoyuIsland = _interopRequireDefault(require(\"./fix/diaoyuIsland.js\"));\n\nvar _BoundingRect = _interopRequireDefault(require(\"zrender/lib/core/BoundingRect.js\"));\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Built-in GEO fixer.\nvar DEFAULT_NAME_PROPERTY = 'name';\n\nvar GeoJSONResource =\n/** @class */\nfunction () {\n  function GeoJSONResource(mapName, geoJSON, specialAreas) {\n    this.type = 'geoJSON';\n    this._parsedMap = (0, _util.createHashMap)();\n    this._mapName = mapName;\n    this._specialAreas = specialAreas; // PENDING: delay the parse to the first usage to rapid up the FMP?\n\n    this._geoJSON = parseInput(geoJSON);\n  }\n  /**\n   * @param nameMap can be null/undefined\n   * @param nameProperty can be null/undefined\n   */\n\n\n  GeoJSONResource.prototype.load = function (nameMap, nameProperty) {\n    nameProperty = nameProperty || DEFAULT_NAME_PROPERTY;\n\n    var parsed = this._parsedMap.get(nameProperty);\n\n    if (!parsed) {\n      var rawRegions = this._parseToRegions(nameProperty);\n\n      parsed = this._parsedMap.set(nameProperty, {\n        regions: rawRegions,\n        boundingRect: calculateBoundingRect(rawRegions)\n      });\n    }\n\n    var regionsMap = (0, _util.createHashMap)();\n    var finalRegions = [];\n    (0, _util.each)(parsed.regions, function (region) {\n      var regionName = region.name; // Try use the alias in geoNameMap\n\n      if (nameMap && (0, _util.hasOwn)(nameMap, regionName)) {\n        region = region.cloneShallow(regionName = nameMap[regionName]);\n      }\n\n      finalRegions.push(region);\n      regionsMap.set(regionName, region);\n    });\n    return {\n      regions: finalRegions,\n      boundingRect: parsed.boundingRect || new _BoundingRect.default(0, 0, 0, 0),\n      regionsMap: regionsMap\n    };\n  };\n\n  GeoJSONResource.prototype._parseToRegions = function (nameProperty) {\n    var mapName = this._mapName;\n    var geoJSON = this._geoJSON;\n    var rawRegions; // https://jsperf.com/try-catch-performance-overhead\n\n    try {\n      rawRegions = geoJSON ? (0, _parseGeoJson.default)(geoJSON, nameProperty) : [];\n    } catch (e) {\n      throw new Error('Invalid geoJson format\\n' + e.message);\n    }\n\n    (0, _nanhai.default)(mapName, rawRegions);\n    (0, _util.each)(rawRegions, function (region) {\n      var regionName = region.name;\n      (0, _textCoord.default)(mapName, region);\n      (0, _diaoyuIsland.default)(mapName, region); // Some area like Alaska in USA map needs to be tansformed\n      // to look better\n\n      var specialArea = this._specialAreas && this._specialAreas[regionName];\n\n      if (specialArea) {\n        region.transformTo(specialArea.left, specialArea.top, specialArea.width, specialArea.height);\n      }\n    }, this);\n    return rawRegions;\n  };\n  /**\n   * Only for exporting to users.\n   * **MUST NOT** used internally.\n   */\n\n\n  GeoJSONResource.prototype.getMapForUser = function () {\n    return {\n      // For backward compatibility, use geoJson\n      // PENDING: it has been returning them without clone.\n      // do we need to avoid outsite modification?\n      geoJson: this._geoJSON,\n      geoJSON: this._geoJSON,\n      specialAreas: this._specialAreas\n    };\n  };\n\n  return GeoJSONResource;\n}();\n\nexports.GeoJSONResource = GeoJSONResource;\n\nfunction calculateBoundingRect(regions) {\n  var rect;\n\n  for (var i = 0; i < regions.length; i++) {\n    var regionRect = regions[i].getBoundingRect();\n    rect = rect || regionRect.clone();\n    rect.union(regionRect);\n  }\n\n  return rect;\n}\n\nfunction parseInput(source) {\n  return !(0, _util.isString)(source) ? source : typeof JSON !== 'undefined' && JSON.parse ? JSON.parse(source) : new Function('return (' + source + ');')();\n}","map":{"version":3,"names":["DEFAULT_NAME_PROPERTY","GeoJSONResource","mapName","geoJSON","specialAreas","type","_parsedMap","createHashMap","_mapName","_specialAreas","_geoJSON","parseInput","prototype","load","nameMap","nameProperty","parsed","get","rawRegions","_parseToRegions","set","regions","boundingRect","calculateBoundingRect","regionsMap","finalRegions","each","region","regionName","name","hasOwn","cloneShallow","push","BoundingRect","parseGeoJson","e","Error","message","fixNanhai","fixTextCoord","fixDiaoyuIsland","specialArea","transformTo","left","top","width","height","getMapForUser","geoJson","rect","i","length","regionRect","getBoundingRect","clone","union","source","isString","JSON","parse","Function"],"sources":["C:/Users/Z/Desktop/efficient/node_modules/echarts/lib/coord/geo/GeoJSONResource.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { each, isString, createHashMap, hasOwn } from 'zrender/lib/core/util.js';\nimport parseGeoJson from './parseGeoJson.js'; // Built-in GEO fixer.\n\nimport fixNanhai from './fix/nanhai.js';\nimport fixTextCoord from './fix/textCoord.js';\nimport fixDiaoyuIsland from './fix/diaoyuIsland.js';\nimport BoundingRect from 'zrender/lib/core/BoundingRect.js';\nvar DEFAULT_NAME_PROPERTY = 'name';\n\nvar GeoJSONResource =\n/** @class */\nfunction () {\n  function GeoJSONResource(mapName, geoJSON, specialAreas) {\n    this.type = 'geoJSON';\n    this._parsedMap = createHashMap();\n    this._mapName = mapName;\n    this._specialAreas = specialAreas; // PENDING: delay the parse to the first usage to rapid up the FMP?\n\n    this._geoJSON = parseInput(geoJSON);\n  }\n  /**\n   * @param nameMap can be null/undefined\n   * @param nameProperty can be null/undefined\n   */\n\n\n  GeoJSONResource.prototype.load = function (nameMap, nameProperty) {\n    nameProperty = nameProperty || DEFAULT_NAME_PROPERTY;\n\n    var parsed = this._parsedMap.get(nameProperty);\n\n    if (!parsed) {\n      var rawRegions = this._parseToRegions(nameProperty);\n\n      parsed = this._parsedMap.set(nameProperty, {\n        regions: rawRegions,\n        boundingRect: calculateBoundingRect(rawRegions)\n      });\n    }\n\n    var regionsMap = createHashMap();\n    var finalRegions = [];\n    each(parsed.regions, function (region) {\n      var regionName = region.name; // Try use the alias in geoNameMap\n\n      if (nameMap && hasOwn(nameMap, regionName)) {\n        region = region.cloneShallow(regionName = nameMap[regionName]);\n      }\n\n      finalRegions.push(region);\n      regionsMap.set(regionName, region);\n    });\n    return {\n      regions: finalRegions,\n      boundingRect: parsed.boundingRect || new BoundingRect(0, 0, 0, 0),\n      regionsMap: regionsMap\n    };\n  };\n\n  GeoJSONResource.prototype._parseToRegions = function (nameProperty) {\n    var mapName = this._mapName;\n    var geoJSON = this._geoJSON;\n    var rawRegions; // https://jsperf.com/try-catch-performance-overhead\n\n    try {\n      rawRegions = geoJSON ? parseGeoJson(geoJSON, nameProperty) : [];\n    } catch (e) {\n      throw new Error('Invalid geoJson format\\n' + e.message);\n    }\n\n    fixNanhai(mapName, rawRegions);\n    each(rawRegions, function (region) {\n      var regionName = region.name;\n      fixTextCoord(mapName, region);\n      fixDiaoyuIsland(mapName, region); // Some area like Alaska in USA map needs to be tansformed\n      // to look better\n\n      var specialArea = this._specialAreas && this._specialAreas[regionName];\n\n      if (specialArea) {\n        region.transformTo(specialArea.left, specialArea.top, specialArea.width, specialArea.height);\n      }\n    }, this);\n    return rawRegions;\n  };\n  /**\n   * Only for exporting to users.\n   * **MUST NOT** used internally.\n   */\n\n\n  GeoJSONResource.prototype.getMapForUser = function () {\n    return {\n      // For backward compatibility, use geoJson\n      // PENDING: it has been returning them without clone.\n      // do we need to avoid outsite modification?\n      geoJson: this._geoJSON,\n      geoJSON: this._geoJSON,\n      specialAreas: this._specialAreas\n    };\n  };\n\n  return GeoJSONResource;\n}();\n\nexport { GeoJSONResource };\n\nfunction calculateBoundingRect(regions) {\n  var rect;\n\n  for (var i = 0; i < regions.length; i++) {\n    var regionRect = regions[i].getBoundingRect();\n    rect = rect || regionRect.clone();\n    rect.union(regionRect);\n  }\n\n  return rect;\n}\n\nfunction parseInput(source) {\n  return !isString(source) ? source : typeof JSON !== 'undefined' && JSON.parse ? JSON.parse(source) : new Function('return (' + source + ');')();\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}